create or replace procedure "FILTRO_POR_MUNICIPIO"
(nombre IN VARCHAR2,
dataset OUT sys_refcursor)
is
begin
   open dataset for SELECT * FROM ESTABLECIMIENTO E INNER JOIN MUNICIPIO M ON(M.ID_MUNICIPIO = E.MUNICIPIO) WHERE M.NOMBRE='CHAHAL';
end;




INSERT INTO ESTABLECIMIENTO (
		CODIGO,
		NOMBRE,
		DIRECCION,
		SUPERVISOR,
		DIRECTOR,
		NIVEL,
		AREA,
		ESTADO,
		MODALIDAD,
		JORNADA,
		PLAN,
		DISTRITO,
		TELEFONO,
		MUNICIPIO,
		DEPARTAMENTO,
		SECTOR
	)
SELECT 
		MA.CODIGO, 
		MA.ESTABLECIMIENTO,
		MA.DIRECCION, 
		S.ID_EMPLEADO_PUBLICO, 
		D.ID_EMPLEADO_PUBLICO,
		N.ID_NIVEL, 
		A.ID_AREA, 
		E.ID_ESTADO, 
		M.ID_MODALIDAD, 
		J.ID_JORNADA,
		P.ID_PLAN,
		MA.DISTRITO, 
		MA.TELEFONO, 
		MU.ID_MUNICIPIO, 
		DEPTO.ID_DEPARTAMENTO,
		SE.ID_SECTOR
FROM MASIVA MA
INNER JOIN MUNICIPIO MU ON (MA.MUNICIPIO = MU.NOMBRE)
INNER JOIN EMPLEADO_PUBLICO S ON (S.NOMBRE = MA.SUPERVISOR)
INNER JOIN EMPLEADO_PUBLICO D ON (D.NOMBRE = MA.DIRECTOR)
INNER JOIN NIVEL N ON (N.NOMBRE = MA.NIVEL)
INNER JOIN SECTOR SE ON (SE.NOMBRE = MA.SECTOR)
INNER JOIN AREA A ON (A.NOMBRE = MA.AREA)
INNER JOIN ESTADO E ON (E.NOMBRE = MA.STATUS)
INNER JOIN MODALIDAD M ON (M.NOMBRE = MA.MODALIDAD)
INNER JOIN JORNADA J ON (J.NOMBRE = MA.JORNADA)
INNER JOIN PLAN P ON (P.NOMBRE = MA.PLAN)
INNER JOIN DEPARTAMENTO DEPTO ON (DEPTO.NOMBRE = MA.DEPARTAMENTO)
GROUP BY
	MA.CODIGO, 
	MA.ESTABLECIMIENTO,
	MA.DIRECCION, 
	S.ID_EMPLEADO_PUBLICO, 
	D.ID_EMPLEADO_PUBLICO,
	N.ID_NIVEL, 
	A.ID_AREA, 
	E.ID_ESTADO, 
	M.ID_MODALIDAD, 
	J.ID_JORNADA,
	P.ID_PLAN,
	MA.DISTRITO, 
	MA.TELEFONO, 
	MU.ID_MUNICIPIO, 
	DEPTO.ID_DEPARTAMENTO,
	SE.ID_SECTOR